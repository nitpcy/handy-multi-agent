## 4.6 Graph RAGåº”ç”¨å®æˆ˜&#x20;

### 4.6.1 Graph RAGä»¥åŠä¸ä¼ ç»ŸRAGçš„ä¼˜åŠ£

Graph RAG æ˜¯å°†çŸ¥è¯†å›¾è°±ï¼ˆKnowledge Graphï¼‰å¼•å…¥æ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰æ¡†æ¶çš„ä¸€ç§æ‰©å±•å½¢å¼ã€‚å®ƒåˆ©ç”¨ç»“æ„åŒ–çš„çŸ¥è¯†æ˜¾å¼è¡¨ç¤ºå®ä½“åŠå…¶å…³ç³»ï¼Œä»è€Œæ˜¾è‘—æå‡ç³»ç»Ÿçš„æ¨ç†èƒ½åŠ›å’Œå›ç­”å‡†ç¡®æ€§ã€‚ç›¸æ¯”äºä¼ ç»Ÿ RAG ä»…åŸºäºå‘é‡æ£€ç´¢çš„æœºåˆ¶ï¼ŒGraph RAG åœ¨å¤æ‚ä»»åŠ¡ä¸­å…·æœ‰ç‹¬ç‰¹çš„ä¼˜åŠ¿ã€‚

**ä¼˜ç‚¹ï¼šæ·±åº¦ç†è§£**ï¼šé€šè¿‡æ˜¾å¼çš„å®ä½“å’Œå…³ç³»è¡¨è¾¾ï¼ŒGraph RAG èƒ½å¤Ÿæ”¯æŒå¤æ‚çš„é—®ç­”å’Œé€»è¾‘æ¨ç†ã€‚**é«˜å‡†ç¡®æ€§**ï¼šç”±äºçŸ¥è¯†å›¾è°±ä¸­çŸ¥è¯†çš„ç»“æ„åŒ–è¡¨ç¤ºï¼Œå‡å°‘äº†ç”Ÿæˆæ¨¡å‹å‡ºç°å¹»è§‰ç°è±¡ï¼ˆhallucinationï¼‰çš„å¯èƒ½æ€§ã€‚

**ç¼ºç‚¹ï¼šæ„å»ºå¤æ‚**ï¼šçŸ¥è¯†å›¾è°±çš„æ„å»ºå’Œç»´æŠ¤éœ€è¦å¤§é‡æ—¶é—´å’Œèµ„æºæŠ•å…¥ã€‚**çµæ´»æ€§æœ‰é™**ï¼šå¯¹äºå®æ—¶æ›´æ–°å’ŒåŠ¨æ€ä¿¡æ¯æ”¯æŒè¾ƒå·®ï¼Œéš¾ä»¥åº”å¯¹å¿«é€Ÿå˜åŒ–çš„åœºæ™¯ã€‚

### 4.6.2 å›¾æ•°æ®åº“ä»‹ç»

å›¾æ•°æ®åº“æ˜¯ Graph RAG çš„æ ¸å¿ƒç»„ä»¶ï¼Œç”¨äºå­˜å‚¨å’Œç®¡ç†çŸ¥è¯†å›¾è°±ã€‚å®ƒèƒ½å¤Ÿé«˜æ•ˆå¤„ç†å¤æ‚çš„å…³ç³»æŸ¥è¯¢ï¼ŒåŒæ—¶æä¾›çµæ´»çš„ç»“æ„å’Œå¼ºå¤§çš„æŸ¥è¯¢èƒ½åŠ›ã€‚

**ç‰¹ç‚¹ï¼šé«˜æ•ˆçš„å…³ç³»æŸ¥è¯¢**ï¼šå›¾æ•°æ®åº“ä¼˜åŒ–äº†å®ä½“ä¸å®ä½“ä¹‹é—´å…³ç³»çš„æŸ¥æ‰¾å’Œæ“ä½œï¼Œæ€§èƒ½ä¼˜äºä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“ã€‚**çµæ´»çš„ç»“æ„**ï¼šæ”¯æŒåŠ¨æ€æ·»åŠ èŠ‚ç‚¹ï¼ˆå®ä½“ï¼‰å’Œè¾¹ï¼ˆå…³ç³»ï¼‰ï¼Œèƒ½å¤Ÿåº”å¯¹å¤šæ ·åŒ–çš„æ•°æ®å˜åŒ–ã€‚**å¼ºå¤§çš„æŸ¥è¯¢è¯­è¨€**ï¼šå¦‚ Neo4j çš„ Cypherï¼Œæ–¹ä¾¿ç”¨æˆ·ç¼–å†™å¤æ‚æŸ¥è¯¢é€»è¾‘ã€‚

**å¸¸ç”¨å›¾æ•°æ®åº“ï¼š**

* **Neo4j**ï¼šåŠŸèƒ½å¼ºå¤§ï¼Œæ˜“äºä½¿ç”¨çš„ä¼ä¸šçº§å›¾æ•°æ®åº“ã€‚

* **JanusGraph**ï¼šåˆ†å¸ƒå¼çš„å¼€æºå›¾æ•°æ®åº“ï¼Œé€‚åˆå¤§è§„æ¨¡å›¾æ•°æ®ç®¡ç†ã€‚

### 4.6.3 æ„å»ºä¸‰å…ƒç»„å¹¶ä¸Šä¼ å›¾æ•°æ®åº“

çŸ¥è¯†å›¾è°±çš„æ ¸å¿ƒæ˜¯ä¸‰å…ƒç»„ï¼ˆTripletsï¼‰ï¼Œç”±èŠ‚ç‚¹ã€å…³ç³»ã€å±æ€§ç»„æˆï¼š

**èŠ‚ç‚¹ï¼ˆNode/Entityï¼‰**ï¼šè¡¨ç¤ºå®ä½“ï¼Œæ˜¯å›¾ä¸­çš„é¡¶ç‚¹

**å…³ç³»ï¼ˆRelationship/Edgeï¼‰**ï¼šè¡¨ç¤ºå®ä½“ä¹‹é—´çš„è”ç³»ï¼Œæ˜¯å›¾ä¸­çš„è¾¹

**å±æ€§ï¼ˆProperty/Attributeï¼‰**ï¼šèŠ‚ç‚¹æˆ–å…³ç³»çš„ç‰¹å¾æè¿°

ä¾‹å¦‚æˆ‘ä»¬çš„æœ‰ä¸€æ®µæ–‡æœ¬ï¼š

```python
text_example = """
CAMELå’ŒDATAWHALEæ˜¯ä¸¤ä¸ªæ´»è·ƒçš„AIå¼€æºç¤¾åŒºã€‚
CAMELè‡´åŠ›äºæ¨åŠ¨äººå·¥æ™ºèƒ½æŠ€æœ¯çš„å‘å±•ï¼Œå¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°è¿›è¡ŒAIç ”ç©¶å’Œåº”ç”¨ã€‚
DateWhaleé€šè¿‡å¼€æºé¡¹ç›®å’Œç¤¾åŒºæ´»åŠ¨ï¼Œä¿ƒè¿›çŸ¥è¯†åˆ†äº«å’ŒæŠ€æœ¯äº¤æµã€‚è¿™ä¸¤ä¸ªç¤¾åŒºéƒ½ä¸ºAIé¢†åŸŸçš„åˆ›æ–°å’Œè¿›æ­¥åšå‡ºäº†é‡è¦è´¡çŒ®ã€‚
"""
```

æˆ‘ä»¬å¯ä»¥ä»ä¸­æ‰¾å‡ºCAMELã€DataWhaleç­‰ç­‰è¿™äº›èŠ‚ç‚¹ï¼Œé‚£ä¹ˆCAMELå’Œäººå·¥æ™ºèƒ½æŠ€æœ¯çš„å‘å±•ä¹‹é—´çš„å…³ç³»å¯ä»¥è¡¨è¿°ä¸ºï¼šCAMEL"è‡´åŠ›äº"äººå·¥æ™ºèƒ½æŠ€æœ¯çš„å‘å±•ã€‚è€ŒCAMELçš„å±æ€§å¯ä»¥ä¸º"AIå¼€æºç¤¾åŒº"ã€‚

1. **ä¿¡æ¯æŠ½å–**

ä¹‹å‰æˆ‘ä»¬å¯èƒ½é€šè¿‡ä¸€äº›NLPæŠ€æœ¯æ¥åšä¿¡æ¯çš„æŠ½å–ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨LLMæ¥å®Œæˆè¿™ä»¶äº‹æƒ…ã€‚ä¾‹å¦‚æˆ‘ä»¬é€šè¿‡ä¸€äº›ç®€å•çš„promptå·¥ç¨‹æ¥å®Œæˆè¿™ä¸ªç›®çš„ï¼š

```python
from camel.models import ModelFactory
from camel.types import ModelPlatformType
from camel.loaders import UnstructuredIO
from camel.agents import ChatAgent

model = ModelFactory.create(
    model_platform=ModelPlatformType.OPENAI_COMPATIBLE_MODEL,
    model_type="Qwen/Qwen2.5-72B-Instruct",
    url='https://api-inference.modelscope.cn/v1/',
    api_key='ä½ çš„apiå¯†é’¥'
)

sys_msg =  """
            ä½ æ˜¯ä¸€ä¸ªå›¾æ•°æ®åº“ä¸“å®¶ï¼Œä½ çš„ä»»åŠ¡æ˜¯ä»ç»™å®šçš„å†…å®¹ä¸­æå–å®ä½“å’Œå…³ç³»ï¼Œæ„å»ºçŸ¥è¯†å›¾è°±ã€‚
            
            çŸ¥è¯†å›¾è°±çš„åŸºæœ¬ç»„æˆï¼š
            1. èŠ‚ç‚¹ï¼ˆNodeï¼‰ï¼šè¡¨ç¤ºå®ä½“ï¼ŒåŒ…å«idå’Œtypeå±æ€§
            2. å…³ç³»ï¼ˆRelationshipï¼‰ï¼šè¡¨ç¤ºå®ä½“ä¹‹é—´çš„è”ç³»
            3. å±æ€§ï¼ˆPropertyï¼‰ï¼šèŠ‚ç‚¹æˆ–å…³ç³»çš„é™„åŠ ä¿¡æ¯

            ç¤ºä¾‹è¾“å…¥ï¼š
            "å°æ˜ï¼Œ2008å¹´9æœˆ13æ—¥å‡ºç”Ÿï¼Œç”·ã€‚äº”è¡Œå±æ°´ï¼Œæ€§æ ¼å¼€æœ—ã€‚"

            æœŸæœ›è¾“å‡ºï¼š
            Nodes:
            Node(id="å°æ˜", type="äºº")
            Node(id="æ°´", type="äº”è¡Œ")
            Node(id="å¼€æœ—", type="æ€§æ ¼")
            Node(id="2008å¹´9æœˆ13æ—¥", type="æ—¶é—´")

            Relationships:
            Relationship(subj=Node(id="å°æ˜", type="äºº"), obj=Node(id="æ°´", type="äº”è¡Œ"), type="äº”è¡Œå±æ€§")
            Relationship(subj=Node(id="å°æ˜", type="äºº"), obj=Node(id="å¼€æœ—", type="æ€§æ ¼"), type="æ€§æ ¼ç‰¹å¾")
            Relationship(subj=Node(id="å°æ˜", type="äºº"), obj=Node(id="2008å¹´9æœˆ13æ—¥", type="æ—¶é—´"), type="å‡ºç”Ÿæ—¥æœŸ")

            è¯·ä»ä»¥ä¸‹å†…å®¹ä¸­æå–å®ä½“å’Œå…³ç³»ï¼š
            """
graphprocessor = ChatAgent(
    system_message=sys_msg,
    model=model,
    )

text_example = """
CAMELå’ŒDATAWHALEæ˜¯ä¸¤ä¸ªæ´»è·ƒçš„AIå¼€æºç¤¾åŒºã€‚
CAMELè‡´åŠ›äºæ¨åŠ¨äººå·¥æ™ºèƒ½æŠ€æœ¯çš„å‘å±•ï¼Œå¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°è¿›è¡ŒAIç ”ç©¶å’Œåº”ç”¨ã€‚
DateWhaleé€šè¿‡å¼€æºé¡¹ç›®å’Œç¤¾åŒºæ´»åŠ¨ï¼Œä¿ƒè¿›çŸ¥è¯†åˆ†äº«å’ŒæŠ€æœ¯äº¤æµã€‚è¿™ä¸¤ä¸ªç¤¾åŒºéƒ½ä¸ºAIé¢†åŸŸçš„åˆ›æ–°å’Œè¿›æ­¥åšå‡ºäº†é‡è¦è´¡çŒ®ã€‚
"""
```

æˆ‘ä»¬é¦–å…ˆé€šè¿‡ä¸€ä¸ªpromptæ¥å®šä¹‰æ¥agentçš„åŠŸèƒ½ï¼Œä»¥åŠè®¾ç½®å¥½æˆ‘ä»¬æ¡ˆä¾‹æ–‡æœ¬ã€‚

```python
response = graphprocessor.step(input_message= text_example)
print (response.msgs[0].content)

>>>
Nodes:
- Node(id="CAMEL", type="AIå¼€æºç¤¾åŒº")
- Node(id="DATAWHALE", type="AIå¼€æºç¤¾åŒº")
- Node(id="æ¨åŠ¨äººå·¥æ™ºèƒ½æŠ€æœ¯çš„å‘å±•", type="ç›®æ ‡")
- Node(id="å¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°è¿›è¡ŒAIç ”ç©¶å’Œåº”ç”¨", type="ç›®æ ‡")
- Node(id="é€šè¿‡å¼€æºé¡¹ç›®å’Œç¤¾åŒºæ´»åŠ¨", type="æ–¹æ³•")
- Node(id="ä¿ƒè¿›çŸ¥è¯†åˆ†äº«å’ŒæŠ€æœ¯äº¤æµ", type="ç›®æ ‡")
- Node(id="AIé¢†åŸŸçš„åˆ›æ–°å’Œè¿›æ­¥", type="è´¡çŒ®")

Relationships:
- Relationship(subj=Node(id="CAMEL", type="AIå¼€æºç¤¾åŒº"), obj=Node(id="æ¨åŠ¨äººå·¥æ™ºèƒ½æŠ€æœ¯çš„å‘å±•", type="ç›®æ ‡"), type="è‡´åŠ›äº")
- Relationship(subj=Node(id="CAMEL", type="AIå¼€æºç¤¾åŒº"), obj=Node(id="å¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°è¿›è¡ŒAIç ”ç©¶å’Œåº”ç”¨", type="ç›®æ ‡"), type="å¸®åŠ©")
- Relationship(subj=Node(id="DATAWHALE", type="AIå¼€æºç¤¾åŒº"), obj=Node(id="é€šè¿‡å¼€æºé¡¹ç›®å’Œç¤¾åŒºæ´»åŠ¨", type="æ–¹æ³•"), type="é€šè¿‡")
- Relationship(subj=Node(id="DATAWHALE", type="AIå¼€æºç¤¾åŒº"), obj=Node(id="ä¿ƒè¿›çŸ¥è¯†åˆ†äº«å’ŒæŠ€æœ¯äº¤æµ", type="ç›®æ ‡"), type="ä¿ƒè¿›")
- Relationship(subj=Node(id="CAMEL", type="AIå¼€æºç¤¾åŒº"), obj=Node(id="AIé¢†åŸŸçš„åˆ›æ–°å’Œè¿›æ­¥", type="è´¡çŒ®"), type="åšå‡ºè´¡çŒ®")
- Relationship(subj=Node(id="DATAWHALE", type="AIå¼€æºç¤¾åŒº"), obj=Node(id="AIé¢†åŸŸçš„åˆ›æ–°å’Œè¿›æ­¥", type="è´¡çŒ®"), type="åšå‡ºè´¡çŒ®")
```

å¯ä»¥çœ‹åˆ°ï¼Œå¯¹äºä¿¡æ¯æŠ½å–è¿™ä¸ªä»»åŠ¡ï¼ŒLLMèƒ½å®Œæˆçš„ç›¸å½“å‡ºè‰²ã€‚å½“ç„¶å¦‚æœä¸æƒ³è‡ªå·±å†™promptçš„è¯ï¼ŒCAMELä¹Ÿæœ‰é¢„è®¾å¥½çš„KnowledgeGraphAgentä¾›æˆ‘ä»¬ä¸€é”®è°ƒç”¨ï¼Œæ›´æ”¹è¿™é‡Œçš„å‚&#x6570;*`parse_graph_elements`*&#x53EF;ä»¥è®¾å®šAgentè¿”å›çš„ä¿¡æ¯æ ¼å¼ï¼ŒFalseè¿”å›çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè®¾ç½®ä¸ºTrueåˆ™è¿”å›ä¸€ä¸ªè‡ªå®šä¹‰çš„GraphElementç±»ï¼š

```python
uio = UnstructuredIO()
kg_agent = KnowledgeGraphAgent(model=model)

# ä»ç»™å®šæ–‡æœ¬åˆ›å»ºä¸€ä¸ªå…ƒç´ 
element_example = uio.create_element_from_text(
    text=text_example, element_id="0"
)

# è®©çŸ¥è¯†å›¾è°±Agentæå–èŠ‚ç‚¹å’Œå…³ç³»ä¿¡æ¯
ans_element = kg_agent.run(element_example, parse_graph_elements=False)
print(ans_element)

>>>
### Nodes

- Node(id='CAMEL', type='Community')
- Node(id='DATAWHALE', type='Community')
- Node(id='AI', type='Field')
- Node(id='Developers', type='Group')
- Node(id='Research and Application', type='Activity')
- Node(id='Knowledge Sharing', type='Activity')
- Node(id='Technical Exchange', type='Activity')

### Relationships

- Relationship(subj=Node(id='CAMEL', type='Community'), obj=Node(id='AI', type='Field'), type='ContributesTo')
- Relationship(subj=Node(id='CAMEL', type='Community'), obj=Node(id='Developers', type='Group'), type='Helps')
- Relationship(subj=Node(id='CAMEL', type='Community'), obj=Node(id='Research and Application', type='Activity'), type='Promotes')
- Relationship(subj=Node(id='DATAWHALE', type='Community'), obj=Node(id='AI', type='Field'), type='ContributesTo')
- Relationship(subj=Node(id='DATAWHALE', type='Community'), obj=Node(id='Knowledge Sharing', type='Activity'), type='Facilitates')
- Relationship(subj=Node(id='DATAWHALE', type='Community'), obj=Node(id='Technical Exchange', type='Activity'), type='Facilitates')
```

* **ä¸Šä¼ æ•°æ®åº“**

ç°åœ¨æˆ‘ä»¬æœ‰äº†èŠ‚ç‚¹å’Œå…³ç³»ä¿¡æ¯ï¼Œä¸‹ä¸€æ­¥å°±è¯¥æŠŠä»–ä»¬ä¸Šä¼ åˆ°æ•°æ®åº“é‡Œäº†ã€‚

é¦–å…ˆæˆ‘ä»¬è¦åˆå§‹åŒ–æˆ‘ä»¬çš„å›¾æ•°æ®åº“ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨[Neo4j(ç‚¹å‡»è·³è½¬)](https://neo4j.com/):

```python
from camel.storages import Neo4jGraph

n4j = Neo4jGraph(
    url="ä½ çš„url",
    username="neo4j",
    password="ä½ çš„password",
)
```

CAMELå·²ç»å°†ä¸Šä¼ åˆ°å›¾æ•°æ®è¿™ä¸€ä¸ªæ“ä½œä¸ºæˆ‘ä»¬ä¸€é”®é›†æˆï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨ä¸€ä¸ªç®€å•çš„å‘½ä»¤è°ƒç”¨å³å¯(éœ€è¦æ­é…KnowledgeGraphAgentä¸€èµ·ä½¿ç”¨ï¼Œè®¾å®šparse\_graph\_elements=True)ï¼š

```python
# æ£€æŸ¥å®ä½“ä¿¡æ¯
graph_elements = kg_agent.run(element_example, parse_graph_elements=True)
print(graph_elements)

>>>
nodes=[Node(id='CAMEL', type='Community', properties={'source': 'agent_created'}), Node(id='DATAWHALE', type='Community', properties={'source': 'agent_created'}), Node(id='Artificial Intelligence', type='Field', properties={'source': 'agent_created'}), Node(id='Developers', type='Group', properties={'source': 'agent_created'}), Node(id='Knowledge Sharing', type='Activity', properties={'source': 'agent_created'}), Node(id='Technical Exchange', type='Activity', properties={'source': 'agent_created'})] relationships=[Relationship(subj=Node(id='CAMEL', type='Community', properties={'source': 'agent_created'}), obj=Node(id='Artificial Intelligence', type='Field', properties={'source': 'agent_created'}), type='PromotesDevelopment', properties={'source': 'agent_created'}), Relationship(subj=Node(id='CAMEL', type='Community', properties={'source': 'agent_created'}), obj=Node(id='Developers', type='Group', properties={'source': 'agent_created'}), type='Helps', properties={'source': 'agent_created'}), Relationship(subj=Node(id='DATAWHALE', type='Community', properties={'source': 'agent_created'}), obj=Node(id='Artificial Intelligence', type='Field', properties={'source': 'agent_created'}), type='Promotes', properties={'source': 'agent_created'}), Relationship(subj=Node(id='DATAWHALE', type='Community', properties={'source': 'agent_created'}), obj=Node(id='Knowledge Sharing', type='Activity', properties={'source': 'agent_created'}), type='Facilitates', properties={'source': 'agent_created'}), Relationship(subj=Node(id='DATAWHALE', type='Community', properties={'source': 'agent_created'}), obj=Node(id='Technical Exchange', type='Activity', properties={'source': 'agent_created'}), type='Facilitates', properties={'source': 'agent_created'}), Relationship(subj=Node(id='CAMEL', type='Community', properties={'source': 'agent_created'}), obj=Node(id='Artificial Intelligence', type='Field', properties={'source': 'agent_created'}), type='ContributesTo', properties={'source': 'agent_created'}), Relationship(subj=Node(id='DATAWHALE', type='Community', properties={'source': 'agent_created'}), obj=Node(id='Artificial Intelligence', type='Field', properties={'source': 'agent_created'}), type='ContributesTo', properties={'source': 'agent_created'})] source=<unstructured.documents.elements.Text object at 0x000001BB8B599460>
```

å°†æå–çš„å›¾ä¿¡æ¯æ·»åŠ åˆ° Neo4j æ•°æ®åº“ä¸­ï¼š

```python
n4j.add_graph_elements(graph_elements=[graph_elements])
```

![](../images/image-31.png)

æˆ‘ä»¬å†å›åˆ°neo4jå°±å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ„å»ºçš„çŸ¥è¯†å›¾è°±å•¦ï¼

### 4.6.4 å®è·µæ¡ˆä¾‹

åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†å±•ç¤ºå¦‚ä½•ä»¥æ··åˆæ–¹å¼è¿è¡Œ RAGï¼Œç»“åˆå‘é‡æ£€ç´¢å’ŒçŸ¥è¯†å›¾è°±æ£€ç´¢ï¼Œä»¥æŸ¥è¯¢å’Œæ¢ç´¢å­˜å‚¨çš„çŸ¥è¯†ã€‚

é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨æœ¬åœ°éƒ¨ç½²çš„e5-large-v2ä½œä¸ºæˆ‘ä»¬çš„embeddingæ¨¡å‹(å¦‚æœæœ¬åœ°æ²¡æœ‰çš„è¯ä¼šè‡ªåŠ¨ä¸‹è½½)ã€‚

```python
from camel.models import ModelFactory
from camel.types import ModelPlatformType, ModelType
from camel.loaders import UnstructuredIO
from camel.storages import Neo4jGraph
from camel.retrievers import AutoRetriever
from camel.types import StorageType
from camel.agents import ChatAgent, KnowledgeGraphAgent
from camel.messages import BaseMessage
from camel.embeddings import SentenceTransformerEncoder

# è®¾ç½®æ£€ç´¢å™¨
camel_retriever = AutoRetriever(
    vector_storage_local_path="local_data/embedding_storage",
    storage_type=StorageType.QDRANT,
    embedding_model=SentenceTransformerEncoder(model_name='intfloat/e5-large-v2'),
)

model = ModelFactory.create(
    model_platform=ModelPlatformType.OPENAI_COMPATIBLE_MODEL,
    model_type="Qwen/Qwen2.5-72B-Instruct",
)

n4j = Neo4jGraph(
    url="ä½ çš„url",
    username="ä½ çš„username",
    password="ä½ çš„å¯†ç ",
)

uio = UnstructuredIO()
kg_agent = KnowledgeGraphAgent(model=model)
```

ä¹‹åæˆ‘ä»¬è®¾ç½®å¥½æˆ‘ä»¬æƒ³äº†è§£çš„å†…å®¹ï¼Œè¿™é‡Œæˆ‘ä»¬é¦–å…ˆè®©å®ƒæ ¹æ®å‘é‡æ£€ç´¢çš„æ–¹å¼æ¥æ£€ç´¢ç›¸å…³ä¿¡æ¯ï¼š

```python
# è®¾ç½®query
query="DataWhaleå’ŒCAMELä¹‹é—´æ˜¯ä»€ä¹ˆå…³ç³»ã€‚"

# ä½¿ç”¨å‘é‡æ£€ç´¢å™¨è·å–ç›¸å…³å†…å®¹
vector_result = camel_retriever.run_vector_retriever(
    query=query,
    contents="""åœ¨ä¸€ä¸ªç¥å¥‡çš„åŠ¨ç‰©ç‹å›½é‡Œï¼Œä½ç€ä¸€åªèªæ˜çš„éª†é©¼ï¼Œåå«CAMELï¼Œä»¥åŠä¸€åªæ™ºæ…§çš„é²¸é±¼ï¼Œåå«DataWhaleã€‚CAMELç”Ÿæ´»åœ¨è¾½é˜”çš„æ²™æ¼ ä¸­ï¼Œè€ŒDataWhaleåˆ™ç•…æ¸¸åœ¨æ— è¾¹æ— é™…çš„æµ·æ´‹é‡Œã€‚è™½ç„¶å®ƒä»¬çš„æ –æ¯åœ°æˆªç„¶ä¸åŒï¼Œä½†å®ƒä»¬éƒ½å¯¹æ¢ç´¢æ–°çŸ¥å……æ»¡äº†æµ“åšçš„å…´è¶£ã€‚

æœ‰ä¸€å¤©ï¼ŒCAMELåœ¨æ²™æ¼ ä¸­å¶ç„¶å‘ç°äº†ä¸€å—å¤è€çš„çŸ³æ¿ï¼Œä¸Šé¢åˆ»æ»¡äº†å¥‡æ€ªçš„ç¬¦å·å’Œå›¾æ¡ˆã€‚CAMELæ„è¯†åˆ°è¿™å¯èƒ½æ˜¯ä¸€ä»½é€šå¾€å·¨å¤§å®è—çš„åœ°å›¾ï¼Œä½†å®ƒæ— æ³•è§£è¯»è¿™äº›ç¬¦å·ã€‚äºæ˜¯ï¼Œå®ƒå†³å®šå»å¯»æ‰¾å¸®åŠ©ã€‚

ä¸æ­¤åŒæ—¶ï¼ŒDataWhaleåœ¨æµ·æ´‹æ·±å¤„å‘ç°äº†ä¸€å·å¤è€çš„ç¾Šçš®çº¸ï¼Œä¸Šé¢ä¹Ÿå¸ƒæ»¡äº†ç±»ä¼¼çš„ç¬¦å·ã€‚è¿™è®©DataWhaleæ„Ÿåˆ°éå¸¸å¥½å¥‡ï¼Œå› ä¸ºå®ƒçŸ¥é“è¿™äº›ç¬¦å·å¯èƒ½è•´è—ç€æŸç§ç§˜å¯†ï¼Œä½†å®ƒåŒæ ·æ— æ³•ç ´è¯‘ã€‚

é€šè¿‡ä¸€åªé£ç¿”åœ¨å¤©ç©ºä¸­çš„ä¿¡ä½¿é¸Ÿï¼ŒCAMELå’ŒDataWhaleå¾—çŸ¥å½¼æ­¤çš„å‘ç°ï¼Œå¹¶å†³å®šåˆä½œè§£å¼€è¿™ä¸ªè°œå›¢ã€‚éª†é©¼è¸ä¸Šäº†æ¼«é•¿çš„æ—…ç¨‹ï¼Œç©¿è¶Šæ²™æ¼ æ¥åˆ°äº†æµ·æ´‹è¾¹ç¼˜ï¼Œè€Œé²¸é±¼åˆ™æ¸¸åˆ°å²¸è¾¹ï¼Œä¸CAMELä¼šåˆã€‚

åœ¨ä¸€èµ·ç ”ç©¶è¿™äº›å¤è€çš„ç¬¦å·æ—¶ï¼ŒCAMELè¿ç”¨äº†å®ƒåœ¨æ²™æ¼ ä¸­ç£¨ç‚¼å‡ºçš„è€å¿ƒå’Œæ™ºæ…§ï¼Œè€ŒDataWhaleåˆ™åˆ©ç”¨å®ƒåœ¨æµ·æ´‹ä¸­è·å¾—çš„çŸ¥è¯†å’Œæ´å¯ŸåŠ›ã€‚ç»è¿‡ä¸€ç•ªåŠªåŠ›ï¼Œå®ƒä»¬ç»ˆäºè§£è¯»å‡ºè¿™äº›ç¬¦å·çš„å«ä¹‰ã€‚åŸæ¥ï¼Œè¿™äº›ç¬¦å·æç»˜çš„æ˜¯ä¸€ä¸ªè¿æ¥æ²™æ¼ å’Œæµ·æ´‹çš„ç§˜å¯†é€šé“ï¼Œé€šé“çš„å°½å¤´è—ç€ä¸€åº§çŸ¥è¯†çš„å®åº“ã€‚

æ»¡æ€€ç€æ¿€åŠ¨ä¸æœŸå¾…ï¼ŒCAMELå’ŒDataWhaleæ²¿ç€åœ°å›¾æ‰€æŒ‡å¼•çš„æ–¹å‘ï¼Œä¸€åŒè¸ä¸Šäº†å¯»æ‰¾å®åº“çš„æ—…ç¨‹ã€‚ä¸€è·¯ä¸Šï¼Œå®ƒä»¬å…‹æœäº†é‡é‡å›°éš¾ï¼Œå½¼æ­¤æ‰¶æŒä¸ä¿¡ä»»ï¼Œç»ˆäºæ‰¾åˆ°äº†é‚£åº§ä¼ è¯´ä¸­çš„å®åº“ã€‚é‡Œé¢å¹¶ä¸æ˜¯é‡‘é“¶è´¢å®ï¼Œè€Œæ˜¯æ— æ•°çš„å¤è€ä¹¦ç±å’ŒçŸ¥è¯†å·è½´ã€‚

é€šè¿‡è¿™æ¬¡å†’é™©ï¼ŒCAMELå’ŒDataWhaleä¸ä»…è·å¾—äº†ä¸°å¯Œçš„çŸ¥è¯†ï¼Œè¿˜å»ºç«‹äº†æ·±åšçš„å‹è°Šã€‚å®ƒä»¬å°†è¿™äº›çŸ¥è¯†å¸¦å›äº†å„è‡ªçš„å®¶å›­ï¼Œä¸å…¶ä»–åŠ¨ç‰©åˆ†äº«ï¼Œä»è€Œæ¨åŠ¨äº†æ•´ä¸ªåŠ¨ç‰©ç‹å›½çš„è¿›æ­¥ä¸å‘å±•ã€‚

è¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬ï¼Œä¸åŒèƒŒæ™¯å’Œèƒ½åŠ›çš„ä¸ªä½“ï¼Œé€šè¿‡åˆä½œä¸åˆ†äº«ï¼Œèƒ½å¤Ÿåˆ›é€ å‡ºè¶…è¶Šæƒ³è±¡çš„æˆæœï¼Œå¼€æ‹“å‡ºæ›´ä¸ºå¹¿é˜”çš„æœªæ¥ã€‚CAMELå’ŒDataWhaleçš„å‹è°Šä¹Ÿæˆä¸ºäº†åŠ¨ç‰©ç‹å›½ä¸­æµä¼ ä¸æ¯çš„ä¼ å¥‡ã€‚""",
)

# æ‰“å°å‘é‡æ£€ç´¢çš„ç»“æœ
print(vector_result)

>>>
{'Original Query': 'DataWhaleå’ŒCAMELä¹‹é—´æ˜¯ä»€ä¹ˆå…³ç³»ã€‚', 'Retrieved Context': ['åœ¨ä¸€ä¸ªç¥å¥‡çš„åŠ¨ç‰©ç‹å›½é‡Œï¼Œä½ç€ä¸€åªèªæ˜çš„éª†é©¼ï¼Œåå«CAMELï¼Œä»¥åŠä¸€åªæ™ºæ…§çš„é²¸é±¼ï¼Œåå«DataWhaleã€‚CAMELç”Ÿæ´»åœ¨è¾½é˜”çš„æ²™æ¼ ä¸­ï¼Œè€ŒDataWhaleåˆ™ç•…æ¸¸åœ¨æ— è¾¹æ— é™…çš„æµ·æ´‹é‡Œã€‚è™½ç„¶å®ƒä»¬çš„æ –æ¯åœ°æˆªç„¶ä¸åŒï¼Œä½†å®ƒä»¬éƒ½å¯¹æ¢ç´¢æ–°çŸ¥å……æ»¡äº†æµ“åšçš„å…´è¶£ã€‚\n\næœ‰ä¸€å¤©ï¼ŒCAMELåœ¨æ²™æ¼ ä¸­å¶ç„¶å‘ç°äº†ä¸€å—å¤è€çš„çŸ³æ¿ï¼Œä¸Šé¢åˆ»æ»¡äº†å¥‡æ€ªçš„ç¬¦å·å’Œå›¾æ¡ˆã€‚CAMELæ„è¯†åˆ°è¿™å¯èƒ½æ˜¯ä¸€ä»½é€šå¾€å·¨å¤§å®è—çš„åœ°å›¾ï¼Œä½†å®ƒæ— æ³•è§£è¯»è¿™äº›ç¬¦å·ã€‚äºæ˜¯ï¼Œå®ƒå†³å®šå»å¯»æ‰¾å¸®åŠ©ã€‚\n\nä¸æ­¤åŒæ—¶ï¼ŒDataWhaleåœ¨æµ·æ´‹æ·±å¤„å‘ç°äº†ä¸€å·å¤è€çš„ç¾Šçš®çº¸ï¼Œä¸Šé¢ä¹Ÿå¸ƒæ»¡äº†ç±»ä¼¼çš„ç¬¦å·ã€‚è¿™è®©DataWhaleæ„Ÿåˆ°éå¸¸å¥½å¥‡ï¼Œå› ä¸ºå®ƒçŸ¥é“è¿™äº›ç¬¦å·å¯èƒ½è•´è—ç€æŸç§ç§˜å¯†ï¼Œä½†å®ƒåŒæ ·æ— æ³•ç ´è¯‘ã€‚\n\né€šè¿‡ä¸€åªé£ç¿”åœ¨å¤©ç©ºä¸­çš„ä¿¡ä½¿é¸Ÿï¼ŒCAMELå’ŒDataWhaleå¾—çŸ¥å½¼æ­¤çš„å‘ç°ï¼Œå¹¶å†³å®šåˆä½œè§£å¼€è¿™ä¸ªè°œå›¢ã€‚éª†é©¼è¸ä¸Šäº†æ¼«é•¿çš„æ—…ç¨‹ï¼Œç©¿è¶Šæ²™æ¼ æ¥åˆ°äº†æµ·æ´‹è¾¹ç¼˜ï¼Œè€Œé²¸é±¼åˆ™æ¸¸åˆ°å²¸è¾¹ï¼Œä¸CAMELä¼šåˆã€‚']}

```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºæˆ‘ä»¬çš„çŸ¥è¯†å›¾è°±ï¼š

```python
# ä»CRABç½‘ç«™è§£æå†…å®¹ï¼Œå¹¶ä½¿ç”¨çŸ¥è¯†å›¾è°±Agentåˆ›å»ºçŸ¥è¯†å›¾è°±æ•°æ®ï¼Œå°†ä¿¡æ¯å­˜å‚¨åˆ°å›¾æ•°æ®åº“ä¸­ã€‚

elements = uio.create_element_from_text(
    text="""åœ¨ä¸€ä¸ªç¥å¥‡çš„åŠ¨ç‰©ç‹å›½é‡Œï¼Œä½ç€ä¸€åªèªæ˜çš„éª†é©¼ï¼Œåå«CAMELï¼Œä»¥åŠä¸€åªæ™ºæ…§çš„é²¸é±¼ï¼Œåå«DataWhaleã€‚CAMELç”Ÿæ´»åœ¨è¾½é˜”çš„æ²™æ¼ ä¸­ï¼Œè€ŒDataWhaleåˆ™ç•…æ¸¸åœ¨æ— è¾¹æ— é™…çš„æµ·æ´‹é‡Œã€‚è™½ç„¶å®ƒä»¬çš„æ –æ¯åœ°æˆªç„¶ä¸åŒï¼Œä½†å®ƒä»¬éƒ½å¯¹æ¢ç´¢æ–°çŸ¥å……æ»¡äº†æµ“åšçš„å…´è¶£ã€‚

æœ‰ä¸€å¤©ï¼ŒCAMELåœ¨æ²™æ¼ ä¸­å¶ç„¶å‘ç°äº†ä¸€å—å¤è€çš„çŸ³æ¿ï¼Œä¸Šé¢åˆ»æ»¡äº†å¥‡æ€ªçš„ç¬¦å·å’Œå›¾æ¡ˆã€‚CAMELæ„è¯†åˆ°è¿™å¯èƒ½æ˜¯ä¸€ä»½é€šå¾€å·¨å¤§å®è—çš„åœ°å›¾ï¼Œä½†å®ƒæ— æ³•è§£è¯»è¿™äº›ç¬¦å·ã€‚äºæ˜¯ï¼Œå®ƒå†³å®šå»å¯»æ‰¾å¸®åŠ©ã€‚

ä¸æ­¤åŒæ—¶ï¼ŒDataWhaleåœ¨æµ·æ´‹æ·±å¤„å‘ç°äº†ä¸€å·å¤è€çš„ç¾Šçš®çº¸ï¼Œä¸Šé¢ä¹Ÿå¸ƒæ»¡äº†ç±»ä¼¼çš„ç¬¦å·ã€‚è¿™è®©DataWhaleæ„Ÿåˆ°éå¸¸å¥½å¥‡ï¼Œå› ä¸ºå®ƒçŸ¥é“è¿™äº›ç¬¦å·å¯èƒ½è•´è—ç€æŸç§ç§˜å¯†ï¼Œä½†å®ƒåŒæ ·æ— æ³•ç ´è¯‘ã€‚

é€šè¿‡ä¸€åªé£ç¿”åœ¨å¤©ç©ºä¸­çš„ä¿¡ä½¿é¸Ÿï¼ŒCAMELå’ŒDataWhaleå¾—çŸ¥å½¼æ­¤çš„å‘ç°ï¼Œå¹¶å†³å®šåˆä½œè§£å¼€è¿™ä¸ªè°œå›¢ã€‚éª†é©¼è¸ä¸Šäº†æ¼«é•¿çš„æ—…ç¨‹ï¼Œç©¿è¶Šæ²™æ¼ æ¥åˆ°äº†æµ·æ´‹è¾¹ç¼˜ï¼Œè€Œé²¸é±¼åˆ™æ¸¸åˆ°å²¸è¾¹ï¼Œä¸CAMELä¼šåˆã€‚

åœ¨ä¸€èµ·ç ”ç©¶è¿™äº›å¤è€çš„ç¬¦å·æ—¶ï¼ŒCAMELè¿ç”¨äº†å®ƒåœ¨æ²™æ¼ ä¸­ç£¨ç‚¼å‡ºçš„è€å¿ƒå’Œæ™ºæ…§ï¼Œè€ŒDataWhaleåˆ™åˆ©ç”¨å®ƒåœ¨æµ·æ´‹ä¸­è·å¾—çš„çŸ¥è¯†å’Œæ´å¯ŸåŠ›ã€‚ç»è¿‡ä¸€ç•ªåŠªåŠ›ï¼Œå®ƒä»¬ç»ˆäºè§£è¯»å‡ºè¿™äº›ç¬¦å·çš„å«ä¹‰ã€‚åŸæ¥ï¼Œè¿™äº›ç¬¦å·æç»˜çš„æ˜¯ä¸€ä¸ªè¿æ¥æ²™æ¼ å’Œæµ·æ´‹çš„ç§˜å¯†é€šé“ï¼Œé€šé“çš„å°½å¤´è—ç€ä¸€åº§çŸ¥è¯†çš„å®åº“ã€‚

æ»¡æ€€ç€æ¿€åŠ¨ä¸æœŸå¾…ï¼ŒCAMELå’ŒDataWhaleæ²¿ç€åœ°å›¾æ‰€æŒ‡å¼•çš„æ–¹å‘ï¼Œä¸€åŒè¸ä¸Šäº†å¯»æ‰¾å®åº“çš„æ—…ç¨‹ã€‚ä¸€è·¯ä¸Šï¼Œå®ƒä»¬å…‹æœäº†é‡é‡å›°éš¾ï¼Œå½¼æ­¤æ‰¶æŒä¸ä¿¡ä»»ï¼Œç»ˆäºæ‰¾åˆ°äº†é‚£åº§ä¼ è¯´ä¸­çš„å®åº“ã€‚é‡Œé¢å¹¶ä¸æ˜¯é‡‘é“¶è´¢å®ï¼Œè€Œæ˜¯æ— æ•°çš„å¤è€ä¹¦ç±å’ŒçŸ¥è¯†å·è½´ã€‚

é€šè¿‡è¿™æ¬¡å†’é™©ï¼ŒCAMELå’ŒDataWhaleä¸ä»…è·å¾—äº†ä¸°å¯Œçš„çŸ¥è¯†ï¼Œè¿˜å»ºç«‹äº†æ·±åšçš„å‹è°Šã€‚å®ƒä»¬å°†è¿™äº›çŸ¥è¯†å¸¦å›äº†å„è‡ªçš„å®¶å›­ï¼Œä¸å…¶ä»–åŠ¨ç‰©åˆ†äº«ï¼Œä»è€Œæ¨åŠ¨äº†æ•´ä¸ªåŠ¨ç‰©ç‹å›½çš„è¿›æ­¥ä¸å‘å±•ã€‚

è¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬ï¼Œä¸åŒèƒŒæ™¯å’Œèƒ½åŠ›çš„ä¸ªä½“ï¼Œé€šè¿‡åˆä½œä¸åˆ†äº«ï¼Œèƒ½å¤Ÿåˆ›é€ å‡ºè¶…è¶Šæƒ³è±¡çš„æˆæœï¼Œå¼€æ‹“å‡ºæ›´ä¸ºå¹¿é˜”çš„æœªæ¥ã€‚CAMELå’ŒDataWhaleçš„å‹è°Šä¹Ÿæˆä¸ºäº†åŠ¨ç‰©ç‹å›½ä¸­æµä¼ ä¸æ¯çš„ä¼ å¥‡ã€‚"""
)
)

graph_element = kg_agent.run(elements, parse_graph_elements=True)
n4j.add_graph_elements(graph_elements=[graph_element])
```

ä¸‹é¢è¿™ä¸ªæ¼‚äº®çš„å›¾è°±å°±æ˜¯æˆ‘ä»¬åˆ›å»ºçš„ç»“æœå•¦ï¼

![](../images/image-32.png)

```python
# æ ¹æ®queryåˆ›å»ºä¸€ä¸ªå…ƒç´ 
query_element = uio.create_element_from_text(
    text=query, element_id="1"
)

# è®©çŸ¥è¯†å›¾è°±agentä»æŸ¥è¯¢ä¸­æå–èŠ‚ç‚¹å’Œå…³ç³»ä¿¡æ¯
ans_element = kg_agent.run(query_element, parse_graph_elements=True)

>>>
nodes=[Node(id='DataWhale', type='Organization', properties={'source': 'agent_created'}), Node(id='CAMEL', type='Organization', properties={'source': 'agent_created'})] relationships=[Relationship(subj=Node(id='DataWhale', type='Organization', properties={'source': 'agent_created'}), obj=Node(id='CAMEL', type='Organization', properties={'source': 'agent_created'}), type='åˆä½œå…³ç³»', properties={'source': 'agent_created'})] source=<unstructured.documents.elements.Text object at 0x00000202AF30AC30>
```

æœ‰ç»†å¿ƒçš„å°ä¼™ä¼´åº”è¯¥å‘ç°äº†ï¼Œæˆ‘ä»¬åœ¨textä¸­å¹¶æ²¡æœ‰ç»™DataWhaleæˆ–è€…CAMELæœ‰'Organization'çš„æè¿°ï¼Œä½†æ˜¯æœ€åçš„ç»“æœå´å«æœ‰ï¼Œè¿™æ˜¯å› ä¸ºåœ¨ä½¿ç”¨KnowledgeGraphAgentçš„runå‡½æ•°æ—¶ä¼šå°†æ£€ç´¢çš„åˆ°çš„ç»“æœå†ç»è¿‡ä¸€éå¤§æ¨¡å‹çš„æ¶¦è‰²ï¼Œæˆ‘ä»¬å¦‚æœæƒ³æŸ¥è¯¢åŸå§‹çš„æ•°æ®å¯ä»¥ä½¿ç”¨neo4jçš„æŸ¥è¯¢è¯­å¥ï¼š

**åŒ¹é…çŸ¥è¯†å›¾è°±å­˜å‚¨ä¸­çš„å®ä½“ï¼š**

```python
# åŒ¹é…ä»queryä¸­è·å¾—çš„å®ä½“åœ¨çŸ¥è¯†å›¾è°±å­˜å‚¨å†…å®¹ä¸­çš„ä¿¡æ¯
kg_result = []
for node in ans_element.nodes:
    n4j_query = f"""
MATCH (n {{id: '{node.id}'}})-[r]->(m)
RETURN 'Node ' + n.id + ' (label: ' + labels(n)[0] + ') has relationship ' + type(r) + ' with Node ' + m.id + ' (label: ' + labels(m)[0] + ')' AS Description
UNION
MATCH (n)<-[r]-(m {{id: '{node.id}'}})
RETURN 'Node ' + m.id + ' (label: ' + labels(m)[0] + ') has relationship ' + type(r) + ' with Node ' + n.id + ' (label: ' + labels(n)[0] + ')' AS Description
"""
    result = n4j.query(query=n4j_query)
    kg_result.extend(result)

kg_result = [item['Description'] for item in kg_result]

# æ˜¾ç¤ºæ¥è‡ªçŸ¥è¯†å›¾è°±æ•°æ®åº“çš„ç»“æœ
print(kg_result)

>>>
['Node DataWhale (label: Animal) has relationship LIVINGIN with Node æµ·æ´‹ (label: Location)', 'Node DataWhale (label: Animal) has relationship DISCOVER with Node å¤è€ç¾Šçš®çº¸ (label: Artifact)', 'Node DataWhale (label: Animal) has relationship TRAVELTO with Node æ²™æ¼  (label: Location)', 'Node DataWhale (label: Animal) has relationship FIND with Node çŸ¥è¯†çš„å®åº“ (label: Treasure)', 'Node CAMEL (label: Animal) has relationship LIVINGIN with Node æ²™æ¼  (label: Location)', 'Node CAMEL (label: Animal) has relationship DISCOVER with Node å¤ä»£çŸ³æ¿ (label: Artifact)', 'Node CAMEL (label: Animal) has relationship COOPERATE with Node DataWhale (label: Animal)', 'Node CAMEL (label: Animal) has relationship TRAVELTO with Node æµ·æ´‹ (label: Location)', 'Node CAMEL (label: Animal) has relationship FIND with Node çŸ¥è¯†çš„å®åº“ (label: Treasure)', 'Node CAMEL (label: Animal) has relationship SHAREKNOWLEDGE with Node DataWhale (label: Animal)']
```

è¿™æ ·å°±å¯ä»¥æ£€ç´¢å‡ºæˆ‘ä»¬queryå¯¹åº”çš„è¿™äº›ä¿¡æ¯å•¦ã€‚

```python
# åˆå¹¶æ¥è‡ªå‘é‡æœç´¢å’ŒçŸ¥è¯†å›¾è°±å®ä½“æœç´¢çš„ç»“æœ
comined_results = str(vector_result) + "\n".join(kg_result)

print(comined_results)
>>>
{'Original Query': 'DataWhaleå’ŒCAMELä¹‹é—´æ˜¯ä»€ä¹ˆå…³ç³»', 'Retrieved Context': ['åœ¨ä¸€ä¸ªç¥å¥‡çš„åŠ¨ç‰©ç‹å›½é‡Œï¼Œä½ç€ä¸€åªèªæ˜çš„éª†é©¼ï¼Œåå«CAMELï¼Œä»¥åŠä¸€åªæ™ºæ…§çš„é²¸é±¼ï¼Œåå«DataWhaleã€‚CAMELç”Ÿæ´»åœ¨è¾½é˜”çš„æ²™æ¼ ä¸­ï¼Œè€ŒDataWhaleåˆ™ç•…æ¸¸åœ¨æ— è¾¹æ— é™…çš„æµ·æ´‹é‡Œã€‚è™½ç„¶å®ƒä»¬çš„æ –æ¯åœ°æˆªç„¶ä¸åŒï¼Œä½†å®ƒä»¬éƒ½å¯¹æ¢ç´¢æ–°çŸ¥å……æ»¡äº†æµ“åšçš„å…´è¶£ã€‚\n\næœ‰ä¸€å¤©ï¼ŒCAMELåœ¨æ²™æ¼ ä¸­å¶ç„¶å‘ç°äº†ä¸€å—å¤è€çš„çŸ³æ¿ï¼Œä¸Šé¢åˆ»æ»¡äº†å¥‡æ€ªçš„ç¬¦å·å’Œå›¾æ¡ˆã€‚CAMELæ„è¯†åˆ°è¿™å¯èƒ½æ˜¯ä¸€ä»½é€šå¾€å·¨å¤§å®è—çš„åœ°å›¾ï¼Œä½†å®ƒæ— æ³•è§£è¯»è¿™äº›ç¬¦å·ã€‚äºæ˜¯ï¼Œå®ƒå†³å®šå»å¯»æ‰¾å¸®åŠ©ã€‚\n\nä¸æ­¤åŒæ—¶ï¼ŒDataWhaleåœ¨æµ·æ´‹æ·±å¤„å‘ç°äº†ä¸€å·å¤è€çš„ç¾Šçš®çº¸ï¼Œä¸Šé¢ä¹Ÿå¸ƒæ»¡äº†ç±»ä¼¼çš„ç¬¦å·ã€‚è¿™è®©DataWhaleæ„Ÿåˆ°éå¸¸å¥½å¥‡ï¼Œå› ä¸ºå®ƒçŸ¥é“è¿™äº›ç¬¦å·å¯èƒ½è•´è—ç€æŸç§ç§˜å¯†ï¼Œä½†å®ƒåŒæ ·æ— æ³•ç ´è¯‘ã€‚\n\né€šè¿‡ä¸€åªé£ç¿”åœ¨å¤©ç©ºä¸­çš„ä¿¡ä½¿é¸Ÿï¼ŒCAMELå’ŒDataWhaleå¾—çŸ¥å½¼æ­¤çš„å‘ç°ï¼Œå¹¶å†³å®šåˆä½œè§£å¼€è¿™ä¸ªè°œå›¢ã€‚éª†é©¼è¸ä¸Šäº†æ¼«é•¿çš„æ—…ç¨‹ï¼Œç©¿è¶Šæ²™æ¼ æ¥åˆ°äº†æµ·æ´‹è¾¹ç¼˜ï¼Œè€Œé²¸é±¼åˆ™æ¸¸åˆ°å²¸è¾¹ï¼Œä¸CAMELä¼šåˆã€‚']}Node DataWhale (label: Animal) has relationship LIVINGIN with Node æµ·æ´‹ (label: Location)
Node DataWhale (label: Animal) has relationship DISCOVER with Node å¤è€ç¾Šçš®çº¸ (label: Artifact)
Node DataWhale (label: Animal) has relationship TRAVELTO with Node æ²™æ¼  (label: Location)
Node DataWhale (label: Animal) has relationship FIND with Node çŸ¥è¯†çš„å®åº“ (label: Treasure)
Node CAMEL (label: Animal) has relationship LIVINGIN with Node æ²™æ¼  (label: Location)
Node CAMEL (label: Animal) has relationship DISCOVER with Node å¤ä»£çŸ³æ¿ (label: Artifact)
Node CAMEL (label: Animal) has relationship COOPERATE with Node DataWhale (label: Animal)
Node CAMEL (label: Animal) has relationship TRAVELTO with Node æµ·æ´‹ (label: Location)
Node CAMEL (label: Animal) has relationship FIND with Node çŸ¥è¯†çš„å®åº“ (label: Treasure)
Node CAMEL (label: Animal) has relationship SHAREKNOWLEDGE with Node DataWhale (label: Animal)
```

```python
# è®¾ç½®ä»£ç†
sys_msg = BaseMessage.make_assistant_message(
    role_name="CAMEL Agent",
    content="""æ‚¨æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„åŠ©æ‰‹æ¥å›ç­”é—®é¢˜ï¼Œ
        æˆ‘å°†ç»™æ‚¨åŸå§‹æŸ¥è¯¢å’Œæ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡ï¼Œ
    æ ¹æ®æ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡å›ç­”åŸå§‹æŸ¥è¯¢ã€‚""",
)

camel_agent = ChatAgent(system_message=sys_msg,
                        model=model)

# å°†æ£€ç´¢åˆ°çš„ä¿¡æ¯ä¼ é€’ç»™æ™ºèƒ½ä½“
user_prompt=f"""
åŸå§‹æŸ¥è¯¢æ˜¯ {query}
æ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡æ˜¯ {comined_results}
"""

user_msg = BaseMessage.make_user_message(
    role_name="CAMEL User", content=user_prompt
)

# è·å–å“åº”
agent_response = camel_agent.step(user_msg)

print(agent_response.msg.content)

>>>
DataWhale å’Œ CAMEL ä¹‹é—´çš„å…³ç³»æ˜¯åˆä½œå’ŒçŸ¥è¯†å…±äº«ã€‚å°½ç®¡å®ƒä»¬ç”Ÿæ´»åœ¨ä¸åŒçš„ç¯å¢ƒä¸­â€”â€”CAMEL ç”Ÿæ´»åœ¨æ²™æ¼ ï¼Œè€Œ DataWhale ç”Ÿæ´»åœ¨æµ·æ´‹ï¼Œä½†å®ƒä»¬éƒ½å‘ç°äº†ç¥ç§˜çš„å¤ä»£æ–‡ç‰©ï¼Œåˆ†åˆ«æ˜¯å¤ä»£çŸ³æ¿å’Œå¤è€ç¾Šçš®çº¸ã€‚é€šè¿‡ä¸€åªä¿¡ä½¿é¸Ÿçš„å¸®åŠ©ï¼Œå®ƒä»¬äº†è§£åˆ°å¯¹æ–¹çš„å‘ç°å¹¶å†³å®šåˆä½œè§£å¼€è¿™äº›æ–‡ç‰©çš„ç§˜å¯†ã€‚CAMEL è·¨è¶Šæ²™æ¼ æ¥åˆ°æµ·æ´‹è¾¹ç¼˜ï¼Œè€Œ DataWhale ä¹Ÿæ¸¸åˆ°å²¸è¾¹ä¸ CAMEL ä¼šåˆã€‚æœ€ç»ˆï¼Œå®ƒä»¬å…±åŒåŠªåŠ›æ‰¾åˆ°äº†çŸ¥è¯†çš„å®åº“ã€‚
```

è‡³æ­¤æ­å–œä½ å­¦ä¼šäº†å¦‚ä½•ä½¿ç”¨åŸºç¡€çš„å‘é‡æ£€ç´¢å’ŒåŸºäºå›¾æ•°æ®åº“çš„æ£€ç´¢ï¼ä¸‹é¢è®©æˆ‘ä»¬çœ‹çœ‹ï¼ŒGraphè¿˜æœ‰å“ªäº›å¯ä»¥ç”¨çš„åœ°æ–¹å§ã€‚

### 4.6.5 è¿›é˜¶æ¡ˆä¾‹

æ¥ä¸‹æ¥çš„æ¡ˆä¾‹ä¼šæ¼”ç¤ºå¦‚ä½•åˆ©ç”¨è®¾ç½®å’Œåˆ©ç”¨ CAMEL çš„æ£€ç´¢å¢å¼ºç”Ÿæˆ ï¼ˆRAGï¼‰ ä¸ Firecrawl ç›¸ç»“åˆï¼Œä»¥å®ç°é«˜æ•ˆçš„ Web æŠ“å–ã€å¤šä»£ç†è§’è‰²æ‰®æ¼”ä»»åŠ¡å’ŒçŸ¥è¯†å›¾è°±æ„å»ºã€‚æˆ‘ä»¬å°†ä½¿ç”¨LLM å¯¹ 2024 å¹´å·´é»å¥¥è¿ä¼šä¸Šçš„åœŸè€³å…¶å°„å‡»è¿åŠ¨å‘˜è¿›è¡Œå…¨é¢ç ”ç©¶ã€‚

åœ¨æœ¬ç¬”è®°æœ¬ä¸­ï¼Œæ‚¨å°†æ¢ç´¢ï¼š

* **CAMELï¼š**&#x4E00;ä¸ªå¼ºå¤§çš„å¤šä»£ç†æ¡†æ¶ï¼Œæ”¯æŒ Retrieval-Augmented Generation å’Œå¤šä»£ç†è§’è‰²æ‰®æ¼”åœºæ™¯ï¼Œå…è®¸æ‰§è¡Œå¤æ‚çš„ AI é©±åŠ¨ä»»åŠ¡ã€‚

* **Firecrawl**ï¼šä¸€ä¸ªå¼ºå¤§çš„ç½‘ç»œæŠ“å–å·¥å…·ï¼Œå¯ç®€åŒ–ä»å„ç§ç½‘é¡µä¸­æå–å’Œæ¸…ç†å†…å®¹çš„è¿‡ç¨‹ã€‚

* **AgentOps**ï¼šè·Ÿè¸ªå’Œåˆ†æ CAMEL Agent çš„è¿è¡Œæƒ…å†µã€‚

* **Qdrant**ï¼šä¸€ç§é«˜æ•ˆçš„å‘é‡å­˜å‚¨ç³»ç»Ÿï¼Œä¸ Camel çš„ AutoRetriever ä¸€èµ·ä½¿ç”¨ï¼Œæ ¹æ®å‘é‡ç›¸ä¼¼æ€§å­˜å‚¨å’Œæ£€ç´¢ç›¸å…³ä¿¡æ¯ã€‚

* **Neo4j**ï¼šé¢†å…ˆçš„å›¾æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œç”¨äºæ„å»ºå’Œå­˜å‚¨çŸ¥è¯†å›¾è°±ï¼Œä½¿å®ä½“ä¹‹é—´çš„å¤æ‚å…³ç³»èƒ½å¤Ÿé«˜æ•ˆæ˜ å°„å’ŒæŸ¥è¯¢ã€‚

* **DuckDuckGo æœç´¢**ï¼š åœ¨ SearchToolkit ä¸­ç”¨äºä» Web æ”¶é›†ç›¸å…³ URL å’Œä¿¡æ¯ï¼Œä½œä¸ºæ£€ç´¢åˆå§‹å†…å®¹çš„ä¸»è¦æœç´¢å¼•æ“ã€‚

* **éç»“æ„åŒ– IOï¼š**&#x7528;äºå†…å®¹åˆ†å—ï¼Œä¾¿äºç®¡ç†éç»“æ„åŒ–æ•°æ®ä»¥å®ç°æ›´é«˜æ•ˆçš„å¤„ç†ã€‚

é¦–å…ˆæˆ‘è¦ç»™æ‰€éœ€è¦çš„å·¥å…·è®¾ç½®å¥½API å¯†é’¥

æ‚¨å¯ä»¥åˆ°[è¿™é‡Œ](https://app.agentops.ai/signin)ä» AgentOps è·å–**å…è´¹çš„** API å¯†é’¥

```python
import os
from getpass import getpass

# è¾“å…¥ AgentOps API å¯†é’¥
agentops_api_key = getpass('è¯·è¾“å…¥æ‚¨çš„ API å¯†é’¥: ')
os.environ["AGENTOPS_API_KEY"] = agentops_api_key
```

æ‚¨å¯ä»¥åˆ°[è¿™é‡Œ](https://www.firecrawl.dev/)ä» Firecrawl è·å–**å…è´¹** API å¯†é’¥

```python
firecrawl_api_key = getpass('Enter your API key: ')
os.environ["FIRECRAWL_API_KEY"] = firecrawl_api_key
```

Firecrawl æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå¯ç®€åŒ–ç½‘é¡µæŠ“å–å’Œæ¸…ç†ç½‘é¡µå†…å®¹çš„è¿‡ç¨‹ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä» CAMEL AI ç½‘ç«™ä¸Šçš„ç‰¹å®šå¸–å­ä¸­æŠ“å–å†…å®¹ä½œä¸ºç¤ºä¾‹ã€‚

```python
from camel.loaders import Firecrawl

firecrawl = Firecrawl()

# ä»æŒ‡å®šçš„ URL æŠ“å–å¹¶æ¸…ç†å†…å®¹
response = firecrawl.scrape(
    url="https://www.camel-ai.org/"
)

print(response["markdown"])

>>>
Aug 9, 2024

# CRAB: Cross-environment Agent Benchmark for Multimodal Language Model Agents

Introducing CRAB: A Benchmark for Cross-Platform Multimodal Agentsã€‚

> Abstract: Recently, spearheaded by the CAMEL-AI community, a pioneer in open-source multi-agent projects, researchers from institutions such as King Abdullah University of Science and Technology, Oxford University, University of Tokyo, Carnegie Mellon University, Stanford University, and Tsinghua University have developed a cross-platform multimodal agent benchmark framework: CRAB, innovatively enabling agents to operate multiple devices simultaneously.

### Introduction

With the rapid development of multimodal large language models (MLLM), many agents capable of operating graphical user interfaces (GUIs) have emerged this year. Various companies have launched their innovative solutions, creating intense competition. GUI agents, leveraging powerful visual understanding and reasoning abilities of large models, can now efficiently and flexibly complete tasks such as booking appointments, shopping, and controlling smart homes.

**This raises the question: will future agents truly be able to sit in front of a computer and work on my behalf?**

However, in today's era of the Internet of Everything, most work requires the coordination of multiple devices. For example, taking a photo with a phone and then transferring it to a computer for editing involves crossing two different devices (environments). Currently, these GUI agents can only operate on a single device, making what is an easy task for humans exceedingly difficult for today's agents.

Researchers from the CAMEL-AI community noticed this problem and proposed the first cross-environment, multi-device agent benchmark frameworkâ€”CRAB, the **CR** oss-environment **A** gent **B** enchmark.

![](https://cdn.prod.website-files.com/6659a155491a54a40551bd7f/66b488289750e3484d51bfb8_66b48746d60ac617f7d0651c_crab-title.png)

Paper link: [https://arxiv.org/abs/2407.01511](https://arxiv.org/abs/2407.01511)

The CAMEL framework ( [https://github.com/camel-ai](https://github.com/camel-ai)) developed by the CAMEL-AI community is one of the earliest open-source multi-agent projects based on large language models. Therefore, community members are researchers and engineers with rich research and practical experience in the field of agents.

In CRAB, the authors not only designed a network-based multi-environment architecture that enables agents to operate multiple devices simultaneously to complete tasks, but also proposed two new technologies to address the issues existing in current agent benchmarks: the graph evaluator and task synthesis. CRAB is not only a brand new benchmark tool but also provides an interaction protocol and its implementation between the environment and agents, which is expected to become an important foundation for agents in practical fields.
...

Copyright Â© 2024 Eigent AI - All Rights Reserved.

Schedule a chat
Output is truncated. View as a scrollable element or open in a text editor. Adjust cell output settings...
```

* **ğŸ› ï¸ ä½¿ç”¨ CAMEL çš„ RAG å’Œ Firecrawl è¿›è¡Œ Web ä¿¡æ¯æ£€ç´¢**

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ Camel çš„ RAG æ¨¡å‹ä» URL åˆ—è¡¨ä¸­æ£€ç´¢ç›¸å…³ä¿¡æ¯ã€‚è¿™å¯¹äºèšåˆå’Œåˆ†ææ¥è‡ªå¤šä¸ªæ¥æºçš„æ•°æ®ç‰¹åˆ«æœ‰ç”¨ã€‚

é¦–å…ˆæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ£€ç´¢æ–¹æ³•ï¼š

```python
from camel.retrievers import AutoRetriever
from camel.toolkits import FunctionTool, SearchToolkit
from camel.types import ModelPlatformType, ModelType, StorageType
from camel.embeddings import SentenceTransformerEncoder

def retrieve_information_from_urls(urls: list[str], query: str) -> str:
    r"""æ ¹æ®ç»™å®šçš„æŸ¥è¯¢ä» URL åˆ—è¡¨ä¸­æ£€ç´¢ç›¸å…³ä¿¡æ¯ã€‚

    æ­¤å‡½æ•°ä½¿ç”¨ `Firecrawl` å·¥å…·ä»æä¾›çš„ URL æŠ“å–å†…å®¹ï¼Œç„¶åä½¿ç”¨ CAMEL çš„ `AutoRetriever` æ ¹æ®æŸ¥è¯¢ä»æŠ“å–çš„å†…å®¹ä¸­æ£€ç´¢æœ€ç›¸å…³çš„ä¿¡æ¯ã€‚

    å‚æ•°:
        urls (list[str]): è¦æŠ“å–å†…å®¹çš„ URL åˆ—è¡¨ã€‚
        query (str): ç”¨äºæœç´¢ç›¸å…³ä¿¡æ¯çš„æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚

    è¿”å›:
        str: æ ¹æ®æŸ¥è¯¢æ£€ç´¢åˆ°çš„æœ€ç›¸å…³ä¿¡æ¯ã€‚

    ç¤ºä¾‹:
        >>> urls = ["https://example.com/article1", "https://example.com/
        article2"]
        >>> query = "æœ€æ–°çš„äººå·¥æ™ºèƒ½è¿›å±•"
        >>> result = retrieve_information_from_urls(urls, query)
    """
    aggregated_content = ''

    # ä»æ¯ä¸ª URL æŠ“å–å¹¶èšåˆå†…å®¹
    for url in urls:
        scraped_content = Firecrawl().scrape(url)
        aggregated_content += scraped_content["markdown"]

    # è®¾ç½®ä¸€ä¸ªå¸¦æœ‰æœ¬åœ°å­˜å‚¨å’Œ Mistral AI åµŒå…¥æ¨¡å‹çš„å‘é‡æ£€ç´¢å™¨
    auto_retriever = AutoRetriever(
        vector_storage_local_path="local_data",
        storage_type=StorageType.QDRANT,
        embedding_model=SentenceTransformerEncoder(),
    )

    # æ ¹æ®æŸ¥è¯¢æ£€ç´¢æœ€ç›¸å…³çš„ä¿¡æ¯
    # æ‚¨å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´ top_k å’Œ similarity_threshold çš„å€¼
    retrieved_info = auto_retriever.run_vector_retriever(
        query=query,
        contents=aggregated_content,
        top_k=3,
        similarity_threshold=0.5,
    )

    return retrieved_info
```

è®©æˆ‘ä»¬é€šè¿‡æ”¶é›†æœ‰å…³ 2024 å¹´å¥¥è¿ä¼šçš„ä¸€äº›ä¿¡æ¯æ¥æµ‹è¯•æ£€ç´¢åŠŸèƒ½ã€‚ç¬¬ä¸€æ¬¡è¿è¡Œå¯èƒ½éœ€è¦å¤§çº¦ 50 ç§’ï¼Œå› ä¸ºå®ƒéœ€è¦æ„å»ºæœ¬åœ°å‘é‡æ•°æ®åº“ã€‚

```python
retrieved_info = retrieve_information_from_urls(
    query="å“ªä¸ªå›½å®¶åœ¨2024å¹´å¥¥è¿ä¼šä¸Šè·å¾—äº†æœ€å¤šçš„é‡‘ç‰Œï¼Ÿ",
    urls=[
        "https://www.nbcnews.com/sports/olympics/united-states-china-gold-medals-rcna166013",
    ],
)

print(retrieved_info)

>>>
{'Original Query': 'å“ªä¸ªå›½å®¶åœ¨2024å¹´å¥¥è¿ä¼šä¸Šè·å¾—äº†æœ€å¤šçš„é‡‘ç‰Œï¼Ÿ', 'Retrieved Context': ['åœ¨2024å¹´å·´é»å¥¥è¿ä¼šä¸Šï¼Œä¸­å›½åˆ›ä¸‹äº†æœ‰å²ä»¥æ¥æœ€ä½³è¡¨ç°ï¼Œä¸ç¾å›½å¹¶åˆ—è·å¾—æœ€å¤šé‡‘ç‰Œã€‚ä¸¤å›½å„è·å¾—40æšé‡‘ç‰Œï¼Œè¿™æ˜¯å¤å­£å¥¥è¿ä¼šä¸Šé‡‘ç‰Œæ•°é‡é¦–æ¬¡å‡ºç°å¹³å±€ã€‚å°½ç®¡å¦‚æ­¤ï¼Œç¾å›½åœ¨å¥–ç‰Œæ€»æ•°ä¸Šä»é¢†å…ˆäºä¸­å›½ï¼Œæ€»å…±è·å¾—126æšå¥–ç‰Œï¼Œè€Œä¸­å›½è·å¾—91æšã€‚\n\n[ä¸­å›½](https://sigma.world/zh-hant/news/remarkable-growth-china-lotter-industry-expected/) åœ¨å°„å‡»å’Œè·³æ°´ç­‰é¡¹ç›®ä¸Šçš„å¼ºåŠ¿è¡¨ç°æœ€åˆä½¿å…¶é¢†å…ˆäºç¾å›½ã€‚ç„¶è€Œï¼Œç¾å›½é˜Ÿåœ¨ç”°å¾„èµ›äº‹ä¸­åæ¥å±…ä¸Šï¼Œæœ€ç»ˆåœ¨å¥–ç‰Œæ€»æ•°ä¸Šè¶…è¿‡ä¸­å›½ã€‚ä¸­å›½åª’ä½“å’Œå…¬ä¼—å¯¹è¿™ä¸€å“è¶Šè¡¨ç°è¡¨ç¤ºåº†ç¥ï¼Œè®¤ä¸ºè¿™æ˜¯å›½å®¶æ—¥ç›Šå¼ºå¤§å’Œç°ä»£åŒ–çš„ä½“ç°ã€‚\n\nMemories of #Paris2024 ğŸ’™ - YouTube\n\nOlympics\n\n14.6M subscribers\n\n[Memories of #Paris2024 ğŸ’™](https://www.youtube.com/watch?v=6c9hFGtSUF8)\n\nOlympics\n\nSearch\n\nInfo\n\nShopping\n\nTap to unmute', '[Watch on YouTube](https://www.youtube.com/watch?v=6c9hFGtSUF8 "Watch on YouTube")\n\n**_å·´é»å¥¥è¿ä¼š2024ç•™å¿µ_**\n\n## æ—¥æœ¬åœ¨å·´é»å¥¥è¿ä¼šä¸Šåˆ›ä¸‹é‡‘ç‰Œæ–°çºªå½•\n\næ—¥æœ¬åœ¨å·´é»ä¹Ÿæœ‰å‡ºè‰²çš„è¡¨ç°ï¼Œèµ¢å¾—20æšé‡‘ç‰Œâ€”â€”è¿™æ˜¯æ—¥æœ¬åœ¨æµ·å¤–å¥¥è¿ä¼šä¸Šè·å¾—çš„æœ€å¤šé‡‘ç‰Œã€‚è¿™ä¸€æˆå°±è¶…è¿‡äº†æ—¥æœ¬åœ¨2004å¹´é›…å…¸å¥¥è¿ä¼šä¸Šè·å¾—çš„16æšæµ·å¤–é‡‘ç‰Œçš„çºªå½•ï¼Œä¹Ÿæ˜¯æ—¥æœ¬ç»§2021å¹´ä¸œäº¬å¥¥è¿ä¼šè·å¾—27æšé‡‘ç‰Œä¹‹åçš„ç¬¬äºŒé«˜é‡‘ç‰Œæ€»æ•°ã€‚\n\n[æ—¥æœ¬](https://sigma.world/zh-hant/news/japan-sports-wagering-reaches-new-heights/) çš„æˆåŠŸä»¥æ‘”è·¤ç­‰å…³é”®ä½“è‚²é¡¹ç›®çš„ç²¾å½©è¡¨ç°ä¸ºäº®ç‚¹ã€‚æœ¨å¤ªéƒåœ¨ç”·å­65å…¬æ–¤è‡ªç”±å¼æ‘”è·¤ä¸­çš„èƒœåˆ©ä»¥åŠåŠ ä¸ŠåŠ è´ºç¾åœ¨å¥³å­76å…¬æ–¤è‡ªç”±å¼æ‘”è·¤ä¸­çš„é‡‘ç‰Œæ˜¯æ—¥æœ¬æˆ˜å½¹ä¸­çš„äº®ç‚¹ä¹‹ä¸€ï¼Œæ—¥æœ¬æ€»å…±è·å¾—äº†45æšå¥–ç‰Œã€‚\n\n## éŸ©å›½è¶…å‡ºé¢„æœŸï¼Œå–å¾—äº†å¤§é‡å¥–ç‰Œ', '[éŸ©å›½](https://sigma.world/zh-hant/news/paradise-co-profit-in1q-2024-up/) ä»¥32æšå¥–ç‰Œï¼ŒåŒ…æ‹¬13æšé‡‘ç‰Œï¼Œä»¤äººæƒŠè®¶ã€‚è¿™æ˜¯è¯¥å›½12å¹´æ¥é¦–æ¬¡åœ¨å•å±Šå¥¥è¿ä¼šä¸Šè¶…è¿‡30æšå¥–ç‰Œã€‚éŸ©å›½é˜Ÿåœ¨å°„å‡»ã€å‡»å‰‘å’Œå°„ç®­é¡¹ç›®ä¸­çš„å‡ºè‰²è¡¨ç°æ¨åŠ¨äº†æˆåŠŸã€‚\n\nå€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒéŸ©å›½å°„ç®­é€‰æ‰‹åœ¨æ‰€æœ‰äº”ä¸ªå°„ç®­é¡¹ç›®ä¸­è·å¾—é‡‘ç‰Œï¼Œé‡‘ä¼˜çœŸæˆä¸ºéŸ©å›½è·å¾—é‡‘ç‰Œæœ€å¤šçš„å¥¥è¿é€‰æ‰‹ï¼ŒèŒä¸šç”Ÿæ¶¯è·å¾—äº”æšé‡‘ç‰Œã€‚å¹´è½»è¿åŠ¨å‘˜çš„æˆåŠŸï¼ŒåŒ…æ‹¬16å²çš„å°„å‡»é€‰æ‰‹ç­å­çï¼Œä»–èµ¢å¾—äº†éŸ©å›½ç¬¬100æšå¤å­£å¥¥è¿ä¼šé‡‘ç‰Œï¼Œæ˜¯è¯¥å›½å–å¾—ä¼˜å¼‚æˆç»©çš„å…³é”®å› ç´ ã€‚\n\n## è²å¾‹å®¾æˆä¸ºä¸œå—äºšè¡¨ç°æœ€ä½³çš„å›½å®¶']}

```

* ğŸ“¹ **ä½¿ç”¨ AgentOps ç›‘æ§ AI ä»£ç†**

```python
import agentops
agentops.init(default_tags=["CAMEL cookbook"])
```

CAMEL çš„ä¸€ä¸ªå¼ºå¤§åŠŸèƒ½æ˜¯å®ƒèƒ½å¤Ÿä»æ–‡æœ¬æ•°æ®æ„å»ºå’Œå­˜å‚¨çŸ¥è¯†å›¾è°±ã€‚è¿™å¾ˆæ–¹ä¾¿æˆ‘ä»¬å¯¹æ•°æ®ä¸­çš„å…³ç³»è¿›è¡Œé«˜çº§åˆ†æå’Œå¯è§†åŒ–ã€‚

é¦–å…ˆæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå‡½æ•°ç”¨äºå¤„ç†è¾“å…¥æ–‡æœ¬ä»¥åˆ›å»ºå’Œæå–èŠ‚ç‚¹å’Œå…³ç³»ï¼Œå¹¶å°†å…¶ä½œä¸ºçŸ¥è¯†å›¾è°±æ·»åŠ åˆ°Neo4jæ•°æ®åº“ä¸­ã€‚

```python
from camel.storages import Neo4jGraph
from camel.loaders import UnstructuredIO
from camel.agents import KnowledgeGraphAgent

def knowledge_graph_builder(text_input: str) -> None:
    r"""ä»æä¾›çš„æ–‡æœ¬æ„å»ºå¹¶å­˜å‚¨çŸ¥è¯†å›¾è°±ã€‚

    æ­¤å‡½æ•°å¤„ç†è¾“å…¥æ–‡æœ¬ä»¥åˆ›å»ºå’Œæå–èŠ‚ç‚¹å’Œå…³ç³»ï¼Œ
    ç„¶åå°†å…¶ä½œä¸ºçŸ¥è¯†å›¾è°±æ·»åŠ åˆ°Neo4jæ•°æ®åº“ä¸­ã€‚

    å‚æ•°ï¼š
        text_input (str): ç”¨äºæ„å»ºçŸ¥è¯†å›¾è°±çš„è¾“å…¥æ–‡æœ¬ã€‚

    è¿”å›ï¼š
        graph_elements: çŸ¥è¯†å›¾è°±ä»£ç†ç”Ÿæˆçš„å›¾å½¢å…ƒç´ ã€‚
    """

    # è®¾ç½®Neo4jå®ä¾‹
    n4j = Neo4jGraph(
        url="Your_URL",
        username="Your_Username",
        password="Your_Password",
    )

    # åˆå§‹åŒ–å®ä¾‹
    uio = UnstructuredIO()
    kg_agent = KnowledgeGraphAgent(model=model)

    # ä»æä¾›çš„æ–‡æœ¬åˆ›å»ºä¸€ä¸ªå…ƒç´ 
    element_example = uio.create_element_from_text(text=text_input, element_id="001")

    # ä½¿ç”¨çŸ¥è¯†å›¾è°±ä»£ç†æå–èŠ‚ç‚¹å’Œå…³ç³»
    graph_elements = kg_agent.run(element_example, parse_graph_elements=True)

    # å°†æå–çš„å›¾å½¢å…ƒç´ æ·»åŠ åˆ°Neo4jæ•°æ®åº“
    n4j.add_graph_elements(graph_elements=[graph_elements])

    return graph_elements
```

ç„¶åæˆ‘ä»¬è®¾ç½®æˆ‘ä»¬çš„RolePlaying,AI ä»£ç†åœ¨å…¶ä¸­äº¤äº’ä»¥ä½¿ç”¨å„ç§å·¥å…·å®Œæˆä»»åŠ¡ã€‚æˆ‘ä»¬å°†æŒ‡å¯¼åŠ©ç†ä»£ç†å¯¹ 2024 å¹´å·´é»å¥¥è¿ä¼šçš„åœŸè€³å…¶å°„å‡»è¿åŠ¨å‘˜è¿›è¡Œå…¨é¢ç ”ç©¶ã€‚

![](../images/image-33.png)

å¯¼å…¥æ¨¡å—åŠå®šä¹‰æˆ‘ä»¬çš„ä»»åŠ¡ï¼š

```python
from typing import List

from colorama import Fore

from camel.societies import RolePlaying
from camel.utils import print_text_animated

task_prompt = """å¯¹2024å¹´å·´é»å¥¥è¿ä¼šçš„åœŸè€³å…¶å°„æ‰‹è¿›è¡Œå…¨é¢ç ”ç©¶ï¼Œä¸ºæˆ‘å†™ä¸€ä»½æŠ¥å‘Šï¼Œç„¶åä¸ºæŠ¥å‘Šåˆ›å»ºçŸ¥è¯†å›¾è°±ã€‚
æ‚¨åº”è¯¥é¦–å…ˆä½¿ç”¨æœç´¢å·¥å…·è·å–ç›¸å…³çš„URLï¼Œç„¶åä½¿ç”¨æ£€ç´¢å·¥å…·é€šè¿‡æä¾›URLåˆ—è¡¨æ¥è·å–æ£€ç´¢åˆ°çš„å†…å®¹ï¼Œæœ€åä½¿ç”¨å·¥å…·æ„å»ºçŸ¥è¯†å›¾è°±ä»¥å®Œæˆä»»åŠ¡ã€‚
ä¸è¦è¿›è¡Œå…¶ä»–æ“ä½œã€‚"""
```

æˆ‘ä»¬å°†ä¸ºåŠ©ç†ä»£ç†é…ç½®ç”¨äºæ•°å­¦è®¡ç®—ã€Web ä¿¡æ¯æ£€ç´¢å’ŒçŸ¥è¯†å›¾è°±æ„å»ºçš„å·¥å…·ã€‚

```python
retrieval_tool = FunctionTool(retrieve_information_from_urls)
search_tool = FunctionTool(SearchToolkit().search_duckduckgo)
knowledge_graph_tool = FunctionTool(knowledge_graph_builder)

tool_list = [
    retrieval_tool,
    search_tool,
    knowledge_graph_tool,
]

assistant_model_config = dict(
    tools=tool_list,
    temperature=0.0,
)

# åˆå§‹åŒ–RolePlaying
role_play_session = RolePlaying(
    assistant_role_name="CAMEL Assistant",
    user_role_name="CAMEL User",
    assistant_agent_kwargs=dict(
        model=model,
        tools=tool_list,
    ),
    user_agent_kwargs=dict(model=model),
    task_prompt=task_prompt,
    with_task_specify=False,
    output_language="ä¸­æ–‡"
)

print(
    Fore.GREEN
    + f"AI Assistant sys message:\n{role_play_session.assistant_sys_msg}\n"
)
print(Fore.BLUE + f"AI User sys message:\n{role_play_session.user_sys_msg}\n")

print(Fore.YELLOW + f"Original task prompt:\n{task_prompt}\n")
print(
    Fore.CYAN
    + "Specified task prompt:"
    + f"\n{role_play_session.specified_task_prompt}\n"
)
print(Fore.RED + f"Final task prompt:\n{role_play_session.task_prompt}\n")
```

å¼€å§‹æˆ‘ä»¬çš„Agentäº¤äº’ã€‚

**æ³¨æ„**ï¼šæ­¤ä¼šè¯å¤§çº¦éœ€è¦ 8 åˆ†é’Ÿã€‚

```python
n = 0
input_msg = role_play_session.init_chat()
while n < 20: # Limit the chat to 20 turns
    n += 1
    assistant_response, user_response = role_play_session.step(input_msg)

    if assistant_response.terminated:
        print(
            Fore.GREEN
            + (
                "AI Assistant terminated. Reason: "
                f"{assistant_response.info['termination_reasons']}."
            )
        )
        break
    if user_response.terminated:
        print(
            Fore.GREEN
            + (
                "AI User terminated. "
                f"Reason: {user_response.info['termination_reasons']}."
            )
        )
        break
    # Print output from the user
    print_text_animated(
        Fore.BLUE + f"AI User:\n\n{user_response.msg.content}\n",
        0.01
    )

    if "CAMEL_TASK_DONE" in user_response.msg.content:
        break

    # Print output from the assistant, including any function
    # execution information
    print_text_animated(Fore.GREEN + "AI Assistant:", 0.01)
    tool_calls = [
        for call in assistant_response.info['tool_calls']
    ]
    for func_record in tool_calls:
        print_text_animated(f"{func_record}", 0.01)
    print_text_animated(f"{assistant_response.msg.content}\n", 0.01)

    input_msg = assistant_response.msg
```

